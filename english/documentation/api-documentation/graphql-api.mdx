---
title: "GraphQL API"
description: "ðŸ›¸"
---

Testing URL:
[https://api-test.koywe.com/graphql](https://api-test.koywe.com/graphql)

This URL runs an Apollo explorer instance, in case you want to test directly
from your browser.

Contact us at [hola@koywe.com](mailto:hola@koywe.com) to get your
[Credentials](/english/documentation/credentials) or to schedule a personalized
tour around the platoform.

**Testing:** Our testing API works on the different testnets of major
blockchains. We have a limited token stock, so we ask your help in not using
them all or returning the tokens once the testing is done.

### Queries and Mutations

To send requests to the GraphQL API, you always have to send a POST request to
the base URL, including the query and any variable as a JSON object. An example
to authenticate using CURL (Authorization header included for illustrative
purposes):

```bash
curl --request POST \
    --header 'content-type: application/json' \
    --header 'Authorization: Bearer JWTTOKEN' \
    --url 'https://api-test.koywe.com/graphql' \
    --data '{"query":"mutation authenticate($input: AuthInput!) {\n  authenticate(input: $input) {\n    token\n  }\n}","variables":{"input":{"clientId":"63631a561f41f8fd18f8c3e0","secret":"supersecretstringFTW"}}}'
```

En the following examples, we will only write down the JSON object.

#### Authentication

```json
"query":
"mutation authenticate($input: AuthInput!) {
  authenticate(input: $input) {
    token
  }
}",
"variables" :
{
  "input": {
    "clientId": "63631a561f41f8fd18f8c3e0",
    "secret": "secretpassword"
    "email": "email@domain.com" â€“-> optional
  }
}
```

#### Pairs

Get the supported currency and token pairs.

Optional: `symbol:` Currency symbol to filter pairs. `clientId`

```json
"query":
"query GetCurrencyTokens($input: GetCurrenciesInput!) {
  GetCurrencyTokens(input: $input) {
    _id
    name
    symbol
    decimals
    tokens {
      _id
      name
      symbol
      lastPrice
      decimals
      internalMarket
      chainId
    }
  }
}",
"variables":
{
  "input": {
    "symbol": null,
    "clientId": null
  }
}
```

#### Payment Methods

List of available payment methods with each method's fees and details for a
specific currency.

Require: `symbol`

Opcional: `clientId.` Payment method list could vary according to this
parameter.

```json
"query":
"query GetPaymentProviderList($input: GetPaymentProviderListInput!) {
  getPaymentProviderList(input: $input) {
    _id
    name
    description
    fee
    image
    details
  }
}",
"variables":
{
  "input": {
    "symbol": "COP"
    "clientId": "63631a561f41f8fd18f8c3e0"
  }
}
```

#### Quote

Returns a quote for the give parameters. When the payment method ID is null, it
returns the cheapest method available.

Requires: `crypto` o `currency`. Amounts in currency or token, one or the other.
`cryptoSymbol`, `currencySymbol`

Optional: `paymentProviderId, clientId`

```json
"query":
"query getPaymentProviderFee($input: GetPaymentProviderInput!) {
  getPaymentProviderFee(input: $input) {
    gasCost
    fee
    cryptoToReceive
    currencyToPay
    Co2
    price
  }
}",
"variables":
{
  "input": {
    //"currency": 100000.00,
    "crypto": 1000,
    "cryptoSymbol":"USDC",
    "currencySymbol":"CLP",
    "paymentProviderId": null
  }
}
```

In all the previous queries, the `clientItd` parameter will be ignored if
there's a JWT Bearer Token in the headers.

### Authenticated Queries

All the following queries require a Bearer Token in the headers:

`Authorization: Bearer [token]`

#### Get Transaction

Transaction details. `transactionId` is the UUID obtained when a transaction is
created or from the transaction list.

Require: `transactionId`

```json
"query":
"query TrackTransaction($input: TransactionTrackingInput!) {
  trackTransaction(input: $input) {
    _id
    from
    txHash
    status
    dates {
      orderedDate
      payedDate
      transactionDate
      deliveredDate
    }
    paymentOrderId {
      _id
      orderId
      address
      tokenId {
        symbol
        name
        chainId
      }
      currencyAmount
      amountCrypto
      freezeAmount
      koyweFee
      netFee
      status
      currencyId {
        name
        symbol
      }
    }
    retries
  }
}",
"variables":
{
  "input": {
    "transactionId": "a0eba85f-3428-4d1f-9055-043ddd5a3211"
  }
}
```

#### Transaction List

Returns a list of of all the transactions associated to the `clientId` or
specified `email`.

```json
"query":
"query getTransactions {
  myTransactions {
    _id
    from
    txHash
    status
    paymentOrderId {
      address
      tokenId {
        symbol
        chainId
      }
      currencyAmount
      currencyAmountWOFee
      amountCrypto
      freezeAmount
      koyweFee
      netFee
      status
      paymentProviderId {
        name
      }
      orderId
      currencyId {
        symbol
      }
    }
    dates {
      orderedDate
      payedDate
      transactionDate
      deliveredDate
    }
  }
}"
```

#### Create Order

It creates a buy or sell order, returning a UUID to identify it (`orderId`) and,
depending on the payment method, a URL (`providerData`) to proceed to payment.
It accepts amounts for crypto o currency, not both.

For authenticated calls without an `email`, this parameter must be included to
associate the transaction to a specific account.

If `currencyId` and `currencySymbol` are provided, the latter will be ignored.
The same goes for token.

Require:
`address, tokenId o tokenSymbol, currencyId o currencySymbol, currencyAmount o amountCrypto, paymentProviderId, terms`

Optional: `email` (mandatory if not authenticated with an email),
`documentNumber` (associated to the account)

```json
"query":
"mutation CreatePaymentOrder($input: CreatePaymentOrderInput!) {
  createPaymentOrder(input: $input) {
    orderID
    providerData //usually, a url to redirect the user to finalize payment
  }
}"
"variables":
{
  "input": {
    "address": "0x40f9bf922c23c43acdad71Ab4425280C0ffBD697", // Will return error if address is invalid
    "tokenId": "630cab7fff27aaac82fd841b", // optional if tokenSymbol is sent (id will take priority if both are sent)
    "currencyId": "6294cd18d2b5f912da43e678", // optional if currencySymbol is sent (id will take priority if both are sent)
    "tokenSymbol": "CLP", // optional if tokenId is sent (id will take priority if both are sent)
    "currencySymbol": "USDC", // optional if currencyId is sent (id will take priority if both are sent)
    "currencyAmount": null,
    "paymentProviderId": "632d7fe6237ded3a748112cf", // mandatory, from the list detailed above
    "terms": true, // always true
    "amountCrypto": 10,
    "email": "email@domain.com", // optional if authentication includes one, mandatory if not
    "documentNumber": "11.222.333-5 || CUAS525jGSD || 4235246346", // optional, to make wire transfers easier to approve
  }
}
```
