---
title: 'ü™ù Webhooks & Callbacks'
description: "Don't call us, we'll get back to you"
---

To make you integration easier, we have enabled ways to alert you when something
happens or to define validation services before executing transactions.

### Webhooks

You can setup a URL to recibe requests every time an event is triggered for a
transaction. possible events are:

- `payment_created`: order is created, Koywe awaits the payment in either fiat or crypto.

- `payment_received`: order is paid. Koywe confirms the payment successfully and will deliver the `amountOut`

- `payment_rejected`: order is rejected. Something happened and the order has been rejected. This event is
NOT sent for wire transfers and it's usually due to an error on cancellation on the user's part.

- `payment_expired`: order is expired. Only sent for wire transfers. The user took too long to transfer or Koywe
couldn't detect the payment on time. Another order or quote should be created to secure a price.

Specific on ramp events:
- `crypto_tx_sent`: crypto transaction is sent after fiat payment is confirmed.

- `crypto_delivered`: crypto transaction nis confirmed by the blockchain.

- `crypto_tx_failed`: crypto transaction failed. This <i>shouldn't</i> happen, but does in some minor cases
(1 out of 10 thousand). If it were to happen,
we would retry the transaction.

Specific off ramp events:
- `fiat_sent`: fiat transfer is sent from Koywe's account.

- `fiat_delivered`: fiat is delivered, according to Koywe's bank.

- `invalid_withdrawals_details`: the fiat transfer was attempted, but the bank rejected the transaction because
the account or the owner of the account didn't match existing records. There's a special endpoint to correct these details.
Check out the API docs for more information.

Additionally, you weill be able to defined a `secret` to validate our requests.
Using this secret, we encrypt the request parameters and add the hash for you to
verify:

```js
const signature = crypto
  .createHmac('sha256', secret)
  .update(JSON.stringify(payload))
  .digest('hex');
```

Example of a request:

```json
{
  "eventName": "crypto_delivered", // event, from the list above
  "orderId": "5a3288ea-0bd4-44d2-af11-aae1f88bbd61", // order id
  "timeStamp": "2022-10-26T22:36:41.658Z",
  "signature": "ed40d34ab7a587cf1a16338a16cc7765ae4420936677482bb33f5f738e4f7189" // hash
}
```

### Authentication Callback

You can setup a URL to your API for us to confirm a user is allowed to operate
in your specific context. Every time a user wants to buy, sell, or check private
information associated to your environment, we will send a request to this URL
before proceeding.

Our platform assumes your API will respond _something_ that looks like a boolean
and supports many authentication methods.

<Warning>
  We will default to use the POST method. If you want other methods, please let us know.
</Warning>

An example using pseudo code:

```js
// user buys crypto
const createOrder (payload) {
    if (!validUser(payload.email)) throw new Error('user not allowed');
    else continue
}
// we check with your API before proceeding
const validUser(email) {
    const payload = { email }
    const headers = { 'Authorization': 'Bearer superJWT' }
    const { data } = await axios.post(urlExternalAPI, payload, { headers })
    reurn data
}
```
